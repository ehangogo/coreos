$.fn.tmpl=function(data){
	// 匹配变量
	var regVar=/[$]\{([^}]+)\}/g;
	// 匹配表达式
	var regExp=/<%([^%>]+)%>/g;

	var html=$(this).html();
	
	var tmpl='var p=[];with(obj||{}){p.push("';
	tmpl+=html.replace(/"/g,'\\"').replace(regVar,function(match,code){
		 		return '",'+code+',"';
			}).replace(regExp,function(match, code) {
				return '");'+code+ 'p.push("';
			});
	tmpl+='");}return p.join("");';
	
	html=new Function('obj',tmpl.replace(/\n/g,''))(data);
	return $(html);
}
